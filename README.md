 Лабораторна робота №1

Тема: Робота з файлами та даними у C# (CSV/JSON/XML/XLSX, звіти DOCX/XLSX, графіки)

Студент: Лісовський Данило Олександрович, група КН-22  
Варіант: 19  
Набір даних: Customer Feedback Dataset (відгуки клієнтів)  
Дата: 16.10.2024  
Посилання на репозиторій: https://github.com/Usernamik/lab1/tree/main/Lab%201.2

 1. Мета та завдання

Мета
Розробити Windows Forms додаток на C# для роботи з даними про відгуки клієнтів, що забезпечує імпорт/експорт даних у різних форматах (CSV, JSON, XML, XLSX), фільтрацію, візуалізацію та генерацію звітів.

 Завдання №2
1. Реалізувати імпорт даних з файлів форматів CSV, JSON, XML, XLSX
2. Створити систему фільтрації та відображення даних у DataGridView
3. Реалізувати візуалізацію даних за допомогою графіків (ScottPlot)
4. Розробити систему генерації звітів у форматах DOCX та XLSX
5. Впровадити логування операцій програми
6. Забезпечити валідацію даних

 2. Опис датасету

Назва: Customer Feedback Dataset  
Джерело: Дані про відгуки клієнтів та їх задоволеність продуктами/сервісами

Структура даних

 Сутність Customer (Клієнт)
- `CustomerId` (int) - унікальний ідентифікатор клієнта
- `Age` (int) - вік клієнта
- `Gender` (enum: Male/Female) - стать клієнта
- `Country` (string) - країна проживання
- `Income` (decimal) - дохід клієнта

 Сутність CustomerFeedback (Відгук клієнта)
- `CustomerId` (int) - ідентифікатор клієнта
- `ProductName` (string) - назва продукту
- `Category` (enum: Bronze/Silver/Gold) - категорія якості продукту
- `ServiceQuality` (enum: Low/Medium/High) - якість обслуговування
- `PurchaseFrequency` (int) - частота покупок
- `FeedbackScore` (decimal) - оцінка відгуку
- `LoyaltyLevel` (enum: Low/Medium/High) - рівень лояльності
- `SatisfactionScore` (decimal) - оцінка задоволеності

 3. Архітектура проєкту

Проєкт організовано за принципом багатошарової архітектури:

Lab 1.2/
├── Domain/                    # Доменний шар
│   ├── Entities/             # Сутності (Customer, CustomerFeedback)
│   ├── Enums/                # Перерахування (Gender, ProductCategory, etc.)
│   ├── Interfaces/           # Інтерфейси (IDataProvider)
│   └── Validation/           # Валідатори даних
├── Data/                      # Шар доступу до даних
│   ├── Providers/            # Провайдери даних (CSV, JSON, XML, XLSX)
│   ├── Reports/              # Сервіси генерації звітів (DOCX, XLSX)
│   ├── Logging/              # Система логування
│   └── Helpers/              # Допоміжні класи
└── Lab 1.2/                   # Презентаційний шар (UI)
    ├── Form1.cs              # Головна форма
    ├── ChartForm.cs          # Форма з графіками
    └── Program.cs            # Точка входу

<img width="241" height="437" alt="зображення" src="https://github.com/user-attachments/assets/dafaa586-3aa1-4b34-ad2f-29989bf985af" />


 4. Реалізований функціонал

 4.1. Імпорт даних

Реалізовано імпорт даних з чотирьох форматів через інтерфейс `IDataProvider`:

 CsvDataProvider
- Читання CSV файлів з використанням бібліотеки CsvHelper
- Автоматичне мапування полів на сутності
- Обробка різних роздільників

 JsonDataProvider
- Парсинг JSON файлів через System.Text.Json
- Підтримка вкладених об'єктів
- Десеріалізація в типізовані класи

 XmlDataProvider
- Читання XML через System.Xml.Serialization
- Підтримка XML атрибутів та елементів
- Валідація структури XML

 XlsxDataProvider
- Робота з Excel файлами через ClosedXML
- Читання з першого аркуша
- Автоматичне визначення типів даних

 <img width="1400" height="828" alt="зображення" src="https://github.com/user-attachments/assets/4e64e5a0-d703-4dd3-bde1-20bbdedb60e5" />

 4.2. Відображення та фільтрація даних

 DataGridView
- Відображення всіх полів датасету
- Режим тільки для читання
- Виділення повного рядка при кліку
- Автоматична прокрутка

 Система фільтрації
Реалізовано фільтри за наступними критеріями:
- Стать (Gender) - ComboBox з варіантами Male/Female
- Категорія продукту (Category) - Bronze/Silver/Gold
- Якість сервісу (ServiceQuality) - Low/Medium/High
- Рівень лояльності (LoyaltyLevel) - Low/Medium/High
- Країна (Country) - текстове поле з пошуком за частиною назви

Кнопки:
-Застосувати фільтр - застосовує вибрані критерії
- Скинути фільтр - повертає всі дані

 <img width="1349" height="777" alt="зображення" src="https://github.com/user-attachments/assets/cd15c4ae-25cc-40c7-aaba-b58fe0c88602" />


<img width="1400" height="677" alt="зображення" src="https://github.com/user-attachments/assets/1719f50f-a38c-4b00-bdde-6737e0a90196" />



 4.3. Візуалізація даних (графіки)

Використано бібліотеку ScottPlot для побудови графіків. Реалізовано три типи візуалізацій:

 1. Розподіл за категоріями продуктів
- Стовпчаста діаграма
- Показує кількість відгуків для кожної категорії (Bronze/Silver/Gold)
- Групування даних за полем `Category`

 2. Середня задоволеність за якістю сервісу
- Стовпчаста діаграма
- Відображає середнє значення `SatisfactionScore` для кожного рівня `ServiceQuality`
- Дозволяє побачити залежність задоволеності від якості обслуговування

 3. Топ країн за кількістю відгуків
- Стовпчаста діаграма
- Показує країн з найбільшою кількістю відгуків
- Сортування за спаданням

Перемикання між графіками здійснюється через ComboBox у верхній частині вікна.

  <img width="1110" height="629" alt="зображення" src="https://github.com/user-attachments/assets/7e932864-b683-46f1-a2bd-3a9699b6258f" />


 <img width="993" height="612" alt="зображення" src="https://github.com/user-attachments/assets/e1064940-d23a-4d7f-8ba7-ef4c9a770222" />

Нажаль не вдалось реалізувати поділ на 10 країн але найкаращі це Канада Німеччина Вкликобританія США та Франція
<img width="962" height="622" alt="зображення" src="https://github.com/user-attachments/assets/91544b4f-47dd-4936-b83b-8204a0c2d00e" />



 4.4. Генерація звітів

 DOCX звіт (DocxReportService)
Використано бібліотеку DocumentFormat.OpenXml для створення Word документів.

Структура звіту:
1. Титульна сторінка
   - Назва звіту
   - Інформація про студента (ПІБ, група, варіант)
   - Дата створення

2. Опис датасету
   - Загальна інформація про дані
   - Кількість записів та унікальних клієнтів
   - Перелік основних полів

3. Ключові метрики
   - Таблиця з розрахованими показниками:
     - Загальна кількість відгуків
     - Середня оцінка відгуку
     - Середня задоволеність клієнтів
     - Середня частота покупок

4. Висновки
   - Аналіз даних
   - Найкраща категорія за задоволеністю
   - Загальні висновки про функціонал програми

<img width="765" height="406" alt="зображення" src="https://github.com/user-attachments/assets/bdfa6f0d-1e78-4d4d-ab9e-01a25517aeab" />

<img width="1044" height="950" alt="зображення" src="https://github.com/user-attachments/assets/ccc7f5f7-3a94-4f3e-aadf-6b05299d2c2a" />


 XLSX звіт (XlsxReportService)
Використано бібліотеку ClosedXML для створення Excel файлів.

Структура звіту:
1. Аркуш "Summary"
   - Загальна статистика
   - Ключові показники
   - Форматування з кольорами та стилями

2. Аркуш "Data"
   - Повна таблиця з усіма відфільтрованими даними
   - Заголовки стовпців з жирним шрифтом
   - Автоматична ширина стовпців

 4.5. Логування

Реалізовано систему логування через клас `Logger`:


 4.6. Валідація даних

Реалізовано два валідатори:

 CustomerValidator
- Перевірка віку (> 0)
- Перевірка країни (не пуста)
- Перевірка доходу (>= 0)

 FeedbackValidator
- Перевірка назви продукту (не пуста)
- Перевірка частоти покупок (> 0)
- Перевірка оцінок (в межах допустимих значень)


 5. Використані технології та бібліотеки

 Основні технології
- .NET 8.0- платформа розробки
- C#  - мова програмування
- **Windows Forms** - UI фреймворк

 NuGet пакети
1. CsvHelper - робота з CSV файлами
2. System.Text.Json** - парсинг JSON
3. ClosedXML - робота з Excel файлами
4. DocumentFormat.OpenXml - створення Word документів
5. ScottPlot.WinForms - побудова графіків
6. System.Xml.Serialization** - робота з XML
   
<img width="957" height="692" alt="зображення" src="https://github.com/user-attachments/assets/517d3096-c055-45e7-9539-631053bb3354" />


 6. Інструкція з використання
 Крок 1: Імпорт даних
1. Запустіть програму
2. Виберіть **File → Import** у меню
3. Оберіть файл з даними (CSV, JSON, XML або XLSX)
4. Дані відобразяться в таблиці

 Крок 2: Фільтрація
1. Виберіть критерії фільтрації у відповідних полях
2. Натисніть кнопку **"Застосувати фільтр"**
3. У таблиці відобразяться лише відфільтровані записи
4. Для скидання фільтрів натисніть **"Скинути фільтр"**

 Крок 3: Перегляд графіків
1. Виберіть **View → Show Charts** у меню
2. У новому вікні оберіть тип графіка з випадаючого списку
3. Графік автоматично оновиться

Крок 4: Генерація звітів
1. Для DOCX: **Reports → Generate DOCX Report**
2. Для XLSX: **Reports → Generate XLSX Report**
3. Оберіть місце збереження файлу
4. Звіт буде створено та збережено

 <img width="1319" height="695" alt="зображення" src="https://github.com/user-attachments/assets/8f1d50d6-da8b-4b6d-aa89-38ff2f8c4b34" />



 7. Особливості реалізації

 Патерни проектування
- **Strategy Pattern** - для різних провайдерів даних (IDataProvider)
- **Repository Pattern** - для роботи з даними
- **Service Layer** - для бізнес-логіки звітів

Принципи SOLID
- **Single Responsibility** - кожен клас має одну відповідальність
- **Open/Closed** - легко додати новий формат даних
- **Dependency Inversion** - залежність від абстракцій (IDataProvider)

 Обробка помилок
- Try-catch блоки для всіх операцій вводу/виводу
- Інформативні повідомлення про помилки
- Логування всіх помилок


 8. Результати тестування

Тестування імпорту
 CSV файли - успішно  
 JSON файли - успішно  
 XML файли - успішно  
 XLSX файли - успішно  

Тестування фільтрації
 Фільтр за статтю - працює коректно  
 Фільтр за категорією - працює коректно  
 Фільтр за якістю сервісу - працює коректно  
 Фільтр за лояльністю - працює коректно  
 Фільтр за країною - працює коректно  
 Комбінація фільтрів - працює коректно  

 Тестування візуалізації
 Графік категорій - відображається правильно  
 Графік задоволеності - відображається правильно  
 Графік країн - відображається правильно  

 Тестування звітів
DOCX звіт - генерується коректно  
 XLSX звіт - генерується коректно  


9.Викорстання АI 
Допомога з реалізацією звіту, допомога з аналізу та фіксу помилок.

 10. Висновки

У ході виконання лабораторної роботи було розроблено повнофункціональний Windows Forms додаток для аналізу відгуків клієнтів. 

Досягнуті результати:
1.  Реалізовано імпорт даних з 4 форматів (CSV, JSON, XML, XLSX)
2.  Створено зручний інтерфейс для перегляду та фільтрації даних
3.  Впроваджено візуалізацію даних за допомогою графіків
4.  Розроблено систему генерації звітів у форматах DOCX та XLSX
5.  Реалізовано логування всіх операцій
6.  Застосовано валідацію даних
7.  Використано багатошарову архітектуру та патерни проектування

Отримані навички:
- Робота з різними форматами файлів у C#
- Використання NuGet пакетів
- Написання спецефічного багатошарового проекту
- Побудова графіків за допомогою ScottPlot
- Генерація документів Word та Excel програмно
- Проектування архітектури додатку

Можливості для покращення:
- Реалізувати більше типів графіків
- Додати можливість редагування даних

Програма повністю відповідає поставленим завданням та демонструє практичне застосування технологій роботи з файлами та даними у C#.

Автор
Лісовський Данило Олександрович
Група: КН-22  
Варіант: 19  

GitHub: Usernamik



